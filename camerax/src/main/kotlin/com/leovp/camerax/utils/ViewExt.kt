package com.leovp.camerax.utils

import android.animation.Animator
import android.animation.AnimatorListenerAdapter
import android.widget.ImageButton
import androidx.annotation.DrawableRes

internal fun ImageButton.toggleButton(
    flag: Boolean,
    rotationAngle: Float,
    @DrawableRes firstIcon: Int,
    @DrawableRes secondIcon: Int,
    action: (Boolean) -> Unit
) {
    if (flag) {
        if (rotationY == 0f) rotationY = rotationAngle
        animate().rotationY(0f).apply {
            setListener(object : AnimatorListenerAdapter() {
                override fun onAnimationEnd(animation: Animator) {
                    super.onAnimationEnd(animation)
                    action(!flag)
                }
            })
        }.duration = 200
        postDelayed({ setImageResource(firstIcon) }, 100)
    } else {
        if (rotationY == rotationAngle) rotationY = 0f
        animate().rotationY(rotationAngle).apply {
            setListener(object : AnimatorListenerAdapter() {
                override fun onAnimationEnd(animation: Animator) {
                    super.onAnimationEnd(animation)
                    action(!flag)
                }
            })
        }.duration = 200
        postDelayed({ setImageResource(secondIcon) }, 100)
    }
}
